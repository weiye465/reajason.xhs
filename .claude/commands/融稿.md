---
allowed-tools: Bash, Read, Write, WebFetch, TodoWrite, Edit, MultiEdit, Grep, Glob, Task
argument-hint: <小红书笔记完整链接列表>
description: 融合多篇小红书笔记内容，生成高质量图片文本 + 正文文本
---
## 小红书融稿工作流

### 使用说明

输入小红书笔记链接列表，必须是下面的格式：

- 带token的URL：https://www.xiaohongshu.com/explore/xxxxx?xsec_token=xxx&xsec_source=pc_user

### 前置要求

1. **XHS-Downloader Docker服务**（首次需要启动）

   ```bash
   docker pull joeanamier/xhs-downloader
   docker run --name xhs-api -d -p 5556:5556 \
     -v xhs_downloader_volume:/app/Volume \
     joeanamier/xhs-downloader python main.py api
   ```
2. **PaddleOCR**（首次需要安装）

   ```bash
   pip install paddlepaddle paddleocr
   ```

### 执行步骤

#### 步骤1-3：数据采集和OCR处理

调用xhs_processor.py完成：

- 通过XHS-Downloader API获取笔记数据
- 自动下载无水印图片
- OCR识别所有图片文本
- 生成结构化MD文件

```bash
cd scripts && python xhs_processor.py "$1"
```

#### 步骤4：AI生成图片文本

```markdown
# 任务
基于merged.md中多篇爆款的图片文本，通过赛马机制生成融合的图片文本。

## 核心要求
1. **赛马选优**：将图片文本拆成小单元（如每个问题），在多篇爆款中对比，筛选每个单元最好的内容，最后组装起来
2. **相似度控制**：确保与爆款有85%以上相似度，字数和口吻一致，大小标题保持一致
3. **图片文本特性**：
   - 长度与对标图片文本一致
   - 优化排版：将OCR断句合并成完整语句，避免过度换行
   - 保留避规词（如"he同"、"dai款"）不要修正
   - **必须删除所有作者名称**（如"吃的不多吖"、"橘子"等博主昵称）
4. **内容清理**：
   - 删除所有博主昵称/作者名称
   - 合并被OCR错误断开的句子
   - 每个观点保持语义完整，不要断句
5. **真实感**：保持对话感觉、活人感觉，确保内容一致性
6. **自检**：生成后检查是否与多个竞品类似

## 输入
merged.md中所有爆款的"图片文本"部分

## 输出
1. 文件路径：`ronggao_output/{task_id}/images.md`（必须保存到正确的任务目录）
2. 必须使用如下输出格式:
# 图片文本（融合版）
## 封面图片文本
[内容]
## 图片1文本
[内容]
## 图片2文本
[内容]

[继续其他图片...]
```

#### 步骤5：AI生成标题和正文

```markdown
# 任务
基于images.md图片文本和merged.md中的爆款正文，通过赛马机制生成融合的标题和正文。

## 核心要求
1. **赛马选优**：将正文拆成小单元（如每个问题），在多篇爆款中对比，筛选每个单元最好的内容，最后组装起来
2. **相似度控制**：确保与爆款有85%以上相似度，字数和口吻一致，大小标题保持一致
3. **内容生成原则**：
   - 标题正文主要从merged.md的正文内容中赛马选优生成
   - images.md仅作为内容参考，确保图文呼应
   - 从merged.md学习语言风格（句式、情绪节奏、emoji使用等）
4. **真实感**：保持对话感觉、活人感觉，确保内容一致性
5. **灵活调整**：内容顺序可以调换优化
6. **话题标签清理**：生成的话题标签必须删除[话题]字样
   - 错误：#找工作[话题]# #面试求职[话题]#
   - 正确：#找工作# #面试求职#
7. **自检**：生成后检查是否与多个竞品类似

## 输入
1. merged.md中所有爆款的"正文内容"部分（主要数据源）
2. images.md - 已生成的图片文本（参考用，确保图文呼应）

## 输出
1. 文件路径：`ronggao_output/{task_id}/content.md`（必须保存到正确的任务目录）
2. 内容要求：
   - 只需要标题和正文，不要有任何分析
   - 话题标签处理：删除[话题]字样，如 #找工作[话题]# 改为 #找工作#
```

### 最终输出结构

```
ronggao_output/
└── {task_id}/
    ├── merged.md    # 合并的所有爆款笔记内容
    ├── images.md    # 图片文本
    └── content.md   # 标题+正文
```

### 开始执行

**重要提示**：
- merged.md 已保存在 `ronggao_output/{task_id}/` 文件夹中
- task_id 格式为：`年月日-时分秒-哈希值`（如：20250913-224948-9e5cea）
- 请在同一个任务文件夹内保存 images.md 和 content.md
- **绝对不要**将文件保存到项目根目录

正在处理小红书笔记完整链接列表..
